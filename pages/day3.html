<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Jour 3 ‚Äî D√©veloppement d'API REST Avanc√©</title>
    <link rel="stylesheet" href="../styles/styles.css">
    <link rel="stylesheet" href="../styles/day3.css">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/atom-one-dark.min.css">
</head>
<body>
  <!-- Navigation -->
  <nav class="navbar">
    <div class="nav-container">
      <div class="nav-logo">
        <img src="../assets/logo.jpeg" alt="YNOV Campus" class="logo-img">
        <span class="logo-text">WebServices</span>
      </div>
      <ul class="nav-menu">
        <li class="nav-item"><a href="../index.html" class="nav-link">Accueil</a></li>
        <li class="nav-item dropdown">
          <a href="#" class="nav-link dropdown-toggle">
            <i class="fas fa-calendar-alt"></i> Journ√©es
            <i class="fas fa-chevron-down"></i>
          </a>
          <div class="dropdown-menu">
            <a href="day1.html" class="dropdown-item">Jour 1 - Th√©orie</a>
            <a href="day1FilRouge.html" class="dropdown-item">Jour 1 - Fil Rouge</a>
            <a href="day2.html" class="dropdown-item">Jour 2 - Th√©orie</a>
            <a href="day2FilRouge.html" class="dropdown-item">Jour 2 - Fil Rouge</a>
            <a href="day3.html" class="dropdown-item">Jour 3 - Th√©orie</a>
            <a href="day3FilRouge.html" class="dropdown-item">Jour 3 - Fil Rouge</a>
          </div>
        </li>
        <li class="nav-item"><a href="../index.html#projet" class="nav-link">Projet</a></li>
        <li class="nav-item"><a href="resources.html" class="nav-link">Ressources</a></li>
        <li class="nav-item"><a href="../index.html#contact" class="nav-link">Contact</a></li>
      </ul>
      <div class="hamburger">
        <span class="bar"></span>
        <span class="bar"></span>
        <span class="bar"></span>
      </div>
    </div>
  </nav>

  <!-- Hero -->
  <section class="hero" style="min-height: 60vh;">
    <div class="container">
      <div class="hero-content">
        <div class="hero-text">
          <h1 class="hero-title">Jour 3 ‚Äî D√©veloppement d'API REST Avanc√©</h1>
          <p class="hero-subtitle">Versioning, Documentation et HATEOAS</p>
          <p class="hero-description">Ma√Ætrisez les techniques avanc√©es pour cr√©er des APIs professionnelles, maintenables et bien document√©es.</p>
          <div class="hero-buttons">
            <a href="day3FilRouge.html" class="btn btn-primary">
              <i class="fas fa-code"></i> D√©marrer l'atelier
            </a>
            <a href="../index.html#programme" class="btn btn-secondary"><i class="fas fa-arrow-left"></i>Retour au programme</a>
          </div>
        </div>
        <div class="hero-image-container">
          <img src="../assets/restapi.jpg" alt="Web Services" class="hero-image">
        </div>
      </div>
    </div>
  </section>


  <!-- Objectifs -->
  <section class="introduction">
    <div class="container">
      <div class="section-header">
        <h2 class="section-title">Objectifs d'apprentissage</h2>
      </div>
      <div class="intro-grid">
        <div class="intro-card">
          <div class="card-icon"><i class="fas fa-code-branch"></i></div>
          <h3>Versioning d'API</h3>
          <p>Choisir et impl√©menter une strat√©gie de versioning appropri√©e pour vos APIs.</p>
        </div>
        <div class="intro-card">
          <div class="card-icon"><i class="fas fa-book"></i></div>
          <h3>Documentation OpenAPI</h3>
          <p>Ma√Ætriser OpenAPI/Swagger pour documenter vos APIs de mani√®re professionnelle.</p>
        </div>
        <div class="intro-card">
          <div class="card-icon"><i class="fas fa-link"></i></div>
          <h3>HATEOAS</h3>
          <p>Comprendre et appliquer HATEOAS pour cr√©er des APIs auto-descriptives.</p>
        </div>
        <div class="intro-card">
          <div class="card-icon"><i class="fas fa-tools"></i></div>
          <h3>Outils et bonnes pratiques</h3>
          <p>Utiliser les outils de d√©veloppement et appliquer les bonnes pratiques avanc√©es.</p>
        </div>
      </div>
    </div>
  </section>

  <!-- Contenu de cours approfondi -->
  <section class="programme">
    <div class="container">
      <div class="section-header">
        <h2 class="section-title">D√©veloppement d'API REST Avanc√© ‚Äî Cours d√©taill√©</h2>
        <p class="section-subtitle">Techniques avanc√©es pour cr√©er des APIs professionnelles et maintenables</p>
      </div>

      <!-- Navigation vers Fil Rouge -->
      <div class="navigation-section">
        <div class="nav-buttons">
          <a href="day3FilRouge.html" class="nav-button">
            <i class="fas fa-code"></i> Fil Rouge J3
          </a>
        </div>
      </div>

      <div class="days-container">
        <div class="day-card expanded">
          <div class="day-header">
            <span class="day-number">1</span>
            <span class="day-theme">Versioning d'API</span>
          </div>
          <div class="day-content">
            <div class="day-morning">
              <h4><i class="fas fa-code-branch"></i> Pourquoi versionner une API ?</h4>
              <p>Imaginons une startup de livraison de repas qui lance son API en 2020. Les restaurants peuvent lister leurs plats, les clients peuvent commander. L'endpoint principal est GET /orders qui renvoie :</p>
              
              <div class="json-example">
                <pre><code>{
  "id": 123,
  "customer_name": "Marie Dupont",
  "total": 45.50,
  "items": ["Pizza Margherita", "Salade C√©sar"]
}</code></pre>
              </div>
              
              <p>Deux ans plus tard, en 2022, l'entreprise veut am√©liorer son API. Ils r√©alisent que renvoyer juste les noms des items est insuffisant. Ils veulent renvoyer des objets complets avec prix, quantit√©, options. La nouvelle structure serait :</p>
              
              <div class="json-example">
                <pre><code>{
  "id": 123,
  "customer": {
    "id": 456,
    "name": "Marie Dupont",
    "email": "marie@example.com"
  },
  "total": 45.50,
  "items": [
    {
      "id": 789,
      "name": "Pizza Margherita",
      "price": 12.50,
      "quantity": 2
    }
  ]
}</code></pre>
              </div>
              
              <p>Probl√®me : si vous changez directement l'API existante, vous cassez toutes les applications clientes qui s'attendent √† l'ancien format. Des centaines de restaurants utilisent leur application mobile qui parse customer_name comme une string. Avec le nouveau format, elle crashera en essayant de lire customer.name.</p>
              
              <p>C'est exactement pour √ßa qu'on versionne les APIs. Le versioning permet de faire √©voluer votre API sans casser les clients existants. Les anciens clients continuent d'utiliser v1, les nouveaux clients utilisent v2.</p>

              <h4 class="mt-5"><i class="fas fa-balance-scale"></i> Quand cr√©er une nouvelle version ?</h4>
              <p>Tous les changements ne n√©cessitent pas une nouvelle version. Il faut distinguer les changements compatibles (non-breaking) des changements incompatibles (breaking).</p>

              <h5 class="mt-5">Changements compatibles (pas besoin de nouvelle version)</h5>
              <ul>
                <li><strong>Ajouter un nouveau champ optionnel :</strong> Si vous ajoutez phone_number √† la r√©ponse, les clients existants l'ignoreront simplement. Pas de casse.</li>
                <li><strong>Ajouter un nouvel endpoint :</strong> POST /orders/bulk pour cr√©er plusieurs commandes en une fois. Les clients qui ne l'utilisent pas ne sont pas impact√©s.</li>
                <li><strong>Ajouter une nouvelle valeur dans un enum :</strong> Si vous aviez status: ["pending", "delivered"] et que vous ajoutez "cancelled", les clients existants continueront de g√©rer pending et delivered.</li>
                <li><strong>Rendre un champ obligatoire optionnel :</strong> Si customer_name √©tait obligatoire et devient optionnel, les clients qui l'envoient toujours continueront de fonctionner.</li>
              </ul>

              <h5 class="mt-5">Changements incompatibles (nouvelle version n√©cessaire)</h5>
              <ul>
                <li><strong>Renommer un champ :</strong> customer_name ‚Üí customer.name. Les clients qui lisent customer_name ne trouveront plus ce champ.</li>
                <li><strong>Changer le type d'un champ :</strong> total √©tait un number, devient un string "45.50 EUR". Les clients qui parsent un number crasheront.</li>
                <li><strong>Supprimer un champ :</strong> Si vous enlevez delivery_address, les clients qui en ont besoin ne pourront plus fonctionner.</li>
                <li><strong>Changer la structure d'un champ :</strong> items √©tait un array de strings, devient un array d'objets. Breaking change massif.</li>
                <li><strong>Rendre un champ optionnel obligatoire :</strong> Si email √©tait optionnel et devient obligatoire, les clients qui ne l'envoient pas auront des erreurs 422.</li>
                <li><strong>Changer le comportement d'un endpoint :</strong> DELETE /users/123 supprimait d√©finitivement, maintenant il fait un soft delete. M√™me si la structure de r√©ponse ne change pas, le comportement change, c'est potentiellement breaking.</li>
              </ul>
              
              <div class="highlight-box">
                <h6>üéØ R√®gle d'or</h6>
                <p>En cas de doute, consid√©rez que c'est un breaking change et cr√©ez une nouvelle version.</p>
              </div>

              <h4 class="mt-5"><i class="fas fa-route"></i> Les trois strat√©gies de versioning</h4>
              <p>Il existe trois approches principales pour versionner une API. Chacune a ses avantages et inconv√©nients.</p>

              <h5 class="mt-5">Strat√©gie 1 : Versioning dans l'URI (la plus courante)</h5>
              <div class="code-example">
                <pre><code class="text">https://api.example.com/v1/users
https://api.example.com/v2/users
https://api.example.com/v3/users</code></pre>
              </div>
              
              <p>C'est l'approche la plus r√©pandue et la plus intuitive. La version fait partie de l'URL elle-m√™me.</p>
              
              <div class="comparison-box">
                <div class="good-example">
                  <h6>‚úÖ Avantages :</h6>
                  <ul>
                    <li><strong>Visible et explicite :</strong> Rien qu'en regardant l'URL, vous savez quelle version vous utilisez</li>
                    <li><strong>Cache-friendly :</strong> Les proxies et CDNs peuvent cacher v1 et v2 s√©par√©ment sans confusion</li>
                    <li><strong>Simple √† tester :</strong> Dans Postman, vous changez juste l'URL</li>
                    <li><strong>Compatible navigateur :</strong> Vous pouvez tester dans un navigateur directement</li>
                  </ul>
                </div>
                <div class="bad-example">
                  <h6>‚ùå Inconv√©nients :</h6>
                  <ul>
                    <li><strong>Pas tr√®s "RESTful pur" :</strong> Les puristes arguent que /users/123 devrait pointer vers LA ressource utilisateur, pas vers "la version 1 de la ressource utilisateur"</li>
                    <li><strong>URLs multiples pour la m√™me ressource :</strong> /v1/users/123 et /v2/users/123 sont deux URLs diff√©rentes pour le m√™me utilisateur conceptuel</li>
                  </ul>
                </div>
              </div>

              <h5 class="mt-5">Impl√©mentation :</h5>
              <div class="code-example">
                <pre><code class="javascript">// Node.js/Express
const v1Router = express.Router();
const v2Router = express.Router();

v1Router.get('/users/:id', (req, res) => {
  // Ancienne logique
  res.json({ id: req.params.id, name: 'Marie' });
});

v2Router.get('/users/:id', (req, res) => {
  // Nouvelle logique
  res.json({ 
    id: req.params.id, 
    profile: { name: 'Marie', email: 'marie@example.com' }
  });
});

app.use('/api/v1', v1Router);
app.use('/api/v2', v2Router);</code></pre>
              </div>

              <h5 class="mt-5">Strat√©gie 2 : Versioning par Header</h5>
              <div class="code-example">
                <pre><code class="text">GET /users/123
Accept: application/vnd.example.v1+json

GET /users/123
Accept: application/vnd.example.v2+json</code></pre>
              </div>
              
              <p>La version est sp√©cifi√©e dans un header HTTP, typiquement Accept ou un header custom comme API-Version.</p>
              
              <div class="comparison-box">
                <div class="good-example">
                  <h6>‚úÖ Avantages :</h6>
                  <ul>
                    <li><strong>RESTful pur :</strong> L'URL reste la m√™me, seule la repr√©sentation change</li>
                    <li><strong>URL unique :</strong> /users/123 pointe toujours vers l'utilisateur 123, quelle que soit la version</li>
                    <li><strong>Flexible :</strong> Vous pouvez avoir diff√©rentes versions pour diff√©rents formats (v1 en JSON, v1 en XML...)</li>
                  </ul>
                </div>
                <div class="bad-example">
                  <h6>‚ùå Inconv√©nients :</h6>
                  <ul>
                    <li><strong>Moins visible :</strong> Vous ne voyez pas la version dans l'URL, il faut regarder les headers</li>
                    <li><strong>Difficile √† tester dans un navigateur :</strong> Vous ne pouvez pas simplement coller l'URL</li>
                    <li><strong>Complexit√© du caching :</strong> Les CDNs doivent √™tre configur√©s pour cacher selon les headers, plus complexe</li>
                    <li><strong>Erreurs plus fr√©quentes :</strong> Les d√©veloppeurs oublient souvent de sp√©cifier le header</li>
                  </ul>
                </div>
              </div>

              <h5 class="mt-5">Strat√©gie 3 : Versioning par Query Parameter</h5>
              <div class="code-example">
                <pre><code class="text">GET /users/123?version=1
GET /users/123?version=2</code></pre>
              </div>
              
              <p>La version est pass√©e comme un param√®tre de requ√™te.</p>
              
              <div class="comparison-box">
                <div class="good-example">
                  <h6>‚úÖ Avantages :</h6>
                  <ul>
                    <li><strong>Visible dans l'URL :</strong> Comme l'approche URI, mais sans changer le chemin de base</li>
                    <li><strong>Facile √† tester :</strong> Dans un navigateur ou Postman</li>
                    <li><strong>Optional avec default :</strong> Si pas de param√®tre, utiliser une version par d√©faut</li>
                  </ul>
                </div>
                <div class="bad-example">
                  <h6>‚ùå Inconv√©nients :</h6>
                  <ul>
                    <li><strong>M√©lange version et filtres :</strong> /users?version=2&status=active&page=1 peut devenir confus</li>
                    <li><strong>Moins propre :</strong> Le query parameter est g√©n√©ralement r√©serv√© pour les filtres et options</li>
                    <li><strong>Rarement utilis√© en pratique :</strong> Peu d'APIs majeures utilisent cette approche</li>
                  </ul>
                </div>
              </div>

              <div class="highlight-box">
                <h6>üéØ Quelle strat√©gie choisir ?</h6>
                <p>Pour 90% des cas, <strong>versioning dans l'URI (/v1/, /v2/)</strong> est le meilleur choix. C'est ce que font Google, Twitter, Facebook, Amazon, Netflix. C'est simple, explicite, et tout le monde comprend.</p>
                <p>Utilisez le versioning par header si vous avez des contraintes sp√©cifiques (compatibilit√© avec des standards existants, architecture complexe avec n√©gociation de contenu avanc√©e).</p>
                <p>√âvitez le versioning par query parameter sauf si vous avez une raison tr√®s sp√©cifique.</p>
              </div>

              <h4 class="mt-5"><i class="fas fa-tag"></i> Sch√©ma de versioning s√©mantique</h4>
              <p>Deux approches principales pour num√©roter vos versions :</p>
              
              <h5 class="mt-5">Version majeure uniquement : v1, v2, v3...</h5>
              <ul>
                <li><strong>Simple, clair</strong></li>
                <li><strong>Incr√©mentez seulement pour les breaking changes</strong></li>
                <li><strong>Utilis√© par la plupart des APIs publiques</strong></li>
              </ul>
              
              <h5 class="mt-5">Versioning s√©mantique complet : v1.2.3</h5>
              <ul>
                <li><strong>Major.Minor.Patch (Semver)</strong></li>
                <li><strong>Incr√©mentez Major pour breaking changes, Minor pour nouvelles features compatibles, Patch pour bug fixes</strong></li>
                <li><strong>Plus d'information, mais plus complexe pour une API publique</strong></li>
              </ul>
              
              <div class="highlight-box">
                <h6>üí° Recommandation</h6>
                <p>Pour les APIs REST publiques, restez sur les <strong>versions majeures simples : v1, v2, v3</strong>. Gardez le semver complet pour vos biblioth√®ques et SDKs.</p>
              </div>

              <h4 class="mt-5"><i class="fas fa-history"></i> Gestion de la r√©trocompatibilit√©</h4>
              <p>Une fois que vous avez plusieurs versions, vous devez les maintenir. Mais combien de temps ?</p>
              
              <h5 class="mt-5">Politique de support</h5>
              <p>D√©finissez et communiquez clairement votre politique. Exemple :</p>
              <ul>
                <li><strong>v1 :</strong> Stable, support√©e jusqu'au 31/12/2025</li>
                <li><strong>v2 :</strong> Stable, support√©e jusqu'au 31/12/2027</li>
                <li><strong>v3 :</strong> Beta, production ready Q2 2026</li>
              </ul>
              
              <p><strong>R√®gle classique :</strong> Supportez au minimum les 2 derni√®res versions majeures. Quand v4 sort, v2 reste support√©e, mais v1 entre en d√©pr√©ciation.</p>

              <h5 class="mt-5">Strat√©gie de sunset (coucher de soleil)</h5>
              <p>Quand vous voulez retirer une ancienne version :</p>
              <ul>
                <li><strong>6-12 mois avant :</strong> Annoncez la date de sunset dans votre blog, newsletter, documentation.</li>
                <li><strong>3-6 mois avant :</strong> Ajoutez un header de d√©pr√©ciation dans les r√©ponses :</li>
              </ul>
              
              <div class="code-example">
                <pre><code class="text">Sunset: Sat, 31 Dec 2025 23:59:59 GMT
Deprecation: Sat, 01 Jan 2025 00:00:00 GMT
Link: <https://api.example.com/docs/migration-v2-to-v3>; rel="successor-version"</code></pre>
              </div>
              
              <ul>
                <li><strong>1 mois avant :</strong> Contactez directement les gros clients qui utilisent encore l'ancienne version. Offrez du support pour migrer.</li>
                <li><strong>Jour J :</strong> La version ancienne commence √† renvoyer 410 Gone au lieu de fonctionner normalement.</li>
              </ul>
              
              <div class="json-example">
                <pre><code>{
  "error": "API v1 has been sunset on December 31, 2025",
  "migration_guide": "https://api.example.com/docs/migration-v1-to-v2"
}</code></pre>
              </div>

              <h4 class="mt-5"><i class="fas fa-cogs"></i> Maintien de deux versions en parall√®le</h4>
              <p>Comment maintenir v1 et v2 sans dupliquer tout le code ?</p>
              
              <h5 class="mt-5">Approche 1 : Adapters/Transformers</h5>
              <p>Vous avez une logique m√©tier unique, et des adapters qui transforment les donn√©es pour chaque version.</p>
              
              <div class="code-example">
                <pre><code class="javascript">// Logique m√©tier (version agnostique)
function getUserData(id) {
  return database.query('SELECT * FROM users WHERE id = ?', [id]);
}

// Adapter v1
function transformToV1(userData) {
  return {
    id: userData.id,
    name: userData.full_name,
    email: userData.email_address
  };
}

// Adapter v2
function transformToV2(userData) {
  return {
    id: userData.id,
    profile: {
      name: userData.full_name,
      email: userData.email_address,
      phone: userData.phone_number
    },
    metadata: {
      created_at: userData.created_at,
      updated_at: userData.updated_at
    }
  };
}</code></pre>
              </div>

              <h5 class="mt-5">Approche 2 : Feature flags</h5>
              <p>Pour des changements mineurs, utilisez des feature flags dans le code.</p>
              
              <div class="code-example">
                <pre><code class="javascript">function getUser(id, apiVersion) {
  const user = database.query('SELECT * FROM users WHERE id = ?', [id]);
  
  if (apiVersion === 'v1') {
    return { id: user.id, name: user.full_name };
  } else {
    return { id: user.id, profile: { name: user.full_name, email: user.email }};
  }
}</code></pre>
              </div>
              
              <div class="highlight-box">
                <h6>‚ö†Ô∏è Attention</h6>
                <p>Cette approche devient vite ing√©rable si vous avez trop de versions. Pr√©f√©rez les adapters.</p>
              </div>

              <h4 class="mt-5"><i class="fas fa-exclamation-triangle"></i> D√©pr√©ciation d'endpoints individuels</h4>
              <p>Parfois, vous ne voulez pas d√©pr√©cier toute une version, juste un endpoint sp√©cifique.</p>
              
              <p>Utilisez le header Deprecation (RFC 8594) :</p>
              
              <div class="code-example">
                <pre><code class="text">GET /users/123/legacy-stats

HTTP/1.1 200 OK
Deprecation: Sat, 01 Jan 2026 00:00:00 GMT
Link: <https://api.example.com/users/123/analytics>; rel="alternate"
Sunset: Sat, 01 Jul 2026 23:59:59 GMT

{
  "data": "...",
  "deprecation_notice": "This endpoint is deprecated. Please migrate to /users/{id}/analytics"
}</code></pre>
              </div>
              
              <p>Documentez clairement l'alternative et la timeline.</p>
            </div>
          </div>
        </div>

        <div class="day-card expanded">
          <div class="day-header">
            <span class="day-number">2</span>
            <span class="day-theme">Documentation d'API</span>
          </div>
          <div class="day-content">
            <div class="day-morning">
              <h4><i class="fas fa-book"></i> Pourquoi documenter est crucial</h4>
              <p>Une API sans documentation est comme un restaurant sans menu. Techniquement, vous pouvez demander au serveur "qu'est-ce que vous avez ?", mais c'est laborieux et frustrant.</p>
              
              <p>Imaginons un d√©veloppeur externe qui d√©couvre votre API SmartCity. Il veut int√©grer les √©v√©nements culturels dans son application. Sans documentation :</p>
              
              <ul>
                <li>Il ne sait pas quels endpoints existent</li>
                <li>Il ne sait pas quel format envoyer pour cr√©er un √©v√©nement</li>
                <li>Il ne sait pas quelles erreurs peuvent survenir</li>
                <li>Il ne sait pas s'il doit s'authentifier</li>
                <li>Il ne sait pas quelles limites de rate limiting existent</li>
              </ul>
              
              <p>R√©sultat : il abandonne et va voir une API concurrente mieux document√©e. Une bonne documentation n'est pas un luxe, c'est une n√©cessit√© absolue.</p>

              <h4 class="mt-5"><i class="fas fa-file-code"></i> OpenAPI Specification : le standard de l'industrie</h4>
              <p>OpenAPI (anciennement Swagger) est devenu LE standard pour documenter les APIs REST. C'est un format YAML (ou JSON) qui d√©crit compl√®tement votre API de mani√®re machine-readable.</p>

              <h5 class="mt-5">Histoire rapide</h5>
              <p>En 2011, une entreprise appel√©e Wordnik cr√©e Swagger pour documenter leur propre API. En 2015, Swagger est rachet√© par SmartBear et devient open-source. En 2016, la sp√©cification est donn√©e √† la Linux Foundation et renomm√©e OpenAPI Specification (OAS). Aujourd'hui, c'est le standard adopt√© par Google, Microsoft, IBM, etc.</p>

              <h5 class="mt-5">Exemple concret : SmartCity Events API (simplifi√©)</h5>
              <p>Voici un exemple complet mais simplifi√© avec seulement 3 routes essentielles pour bien comprendre la structure :</p>
              
              <div class="code-example">
                <pre><code class="yaml">openapi: 3.0.3
info:
  title: SmartCity Events API
  version: 1.0.0
  description: |
    API pour g√©rer les √©v√©nements culturels de la ville.
    
    ## Authentification
    La plupart des endpoints n√©cessitent une authentification JWT.
    Obtenez un token via /auth/login et incluez-le dans le header Authorization.
    
  contact:
    name: √âquipe Events
    email: events@smartcity.local

servers:
  - url: https://api.smartcity.local/v1
    description: Production
  - url: http://localhost:3000/api/v1
    description: D√©veloppement local

paths:
  /events:
    get:
      summary: Liste des √©v√©nements
      description: Retourne tous les √©v√©nements √† venir, tri√©s par date
      tags:
        - Events
      parameters:
        - name: page
          in: query
          description: Num√©ro de page (commence √† 1)
          schema:
            type: integer
            minimum: 1
            default: 1
        - name: limit
          in: query
          description: Nombre d'√©v√©nements par page
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 20
        - name: type
          in: query
          description: Filtrer par type d'√©v√©nement
          schema:
            type: string
            enum: [concert, exposition, conference, festival]
      responses:
        '200':
          description: Liste pagin√©e d'√©v√©nements
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/Event'
                  meta:
                    type: object
                    properties:
                      page:
                        type: integer
                      limit:
                        type: integer
                      total:
                        type: integer
              example:
                data:
                  - id: "550e8400-e29b-41d4-a716-446655440000"
                    title: "Jazz sous les √©toiles"
                    type: "concert"
                    start_date: "2025-07-15T20:00:00Z"
                    price: 15.00
                    location:
                      name: "Place du Capitole"
                      city: "Toulouse"
                meta:
                  page: 1
                  limit: 20
                  total: 45

    post:
      summary: Cr√©er un √©v√©nement
      description: Cr√©e un nouvel √©v√©nement culturel
      tags:
        - Events
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/EventInput'
            example:
              title: "Concert de Rock"
              description: "Soir√©e rock avec groupes locaux"
              type: "concert"
              start_date: "2025-08-15T20:00:00Z"
              price: 25.00
              location:
                name: "Zenith de Toulouse"
                city: "Toulouse"
      responses:
        '201':
          description: √âv√©nement cr√©√© avec succ√®s
          headers:
            Location:
              description: URL du nouvel √©v√©nement
              schema:
                type: string
              example: "/events/770e8400-e29b-41d4-a716-446655440002"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Event'
        '400':
          description: Requ√™te invalide
        '401':
          description: Non authentifi√©
        '422':
          description: Erreur de validation

  /events/{id}:
    parameters:
      - name: id
        in: path
        required: true
        description: ID unique de l'√©v√©nement (UUID v4)
        schema:
          type: string
          format: uuid
        example: "550e8400-e29b-41d4-a716-446655440000"

    get:
      summary: D√©tails d'un √©v√©nement
      description: R√©cup√®re les d√©tails complets d'un √©v√©nement sp√©cifique
      tags:
        - Events
      responses:
        '200':
          description: D√©tails de l'√©v√©nement
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Event'
              example:
                id: "550e8400-e29b-41d4-a716-446655440000"
                title: "Jazz sous les √©toiles"
                description: "Soir√©e jazz en plein air avec des artistes locaux"
                type: "concert"
                start_date: "2025-07-15T20:00:00Z"
                end_date: "2025-07-15T23:00:00Z"
                price: 15.00
                max_attendees: 200
                current_attendees: 45
                location:
                  name: "Place du Capitole"
                  address: "Place du Capitole, 31000 Toulouse"
                  city: "Toulouse"
                  coordinates:
                    latitude: 43.6047
                    longitude: 1.4442
                tags: ["musique", "jazz", "ext√©rieur"]
                created_at: "2025-06-01T10:00:00Z"
        '404':
          description: √âv√©nement non trouv√©

components:
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
      description: JWT token obtenu via POST /auth/login

  schemas:
    Event:
      type: object
      required:
        - id
        - title
        - type
        - start_date
        - location
        - price
      properties:
        id:
          type: string
          format: uuid
          description: Identifiant unique de l'√©v√©nement
          example: "550e8400-e29b-41d4-a716-446655440000"
        title:
          type: string
          minLength: 3
          maxLength: 200
          description: Titre de l'√©v√©nement
          example: "Jazz sous les √©toiles"
        description:
          type: string
          maxLength: 2000
          description: Description d√©taill√©e
          example: "Soir√©e jazz en plein air"
        type:
          type: string
          enum: [concert, exposition, conference, festival, sport, autre]
          description: Type d'√©v√©nement
          example: "concert"
        start_date:
          type: string
          format: date-time
          description: Date et heure de d√©but (ISO 8601)
          example: "2025-07-15T20:00:00Z"
        end_date:
          type: string
          format: date-time
          description: Date et heure de fin (optionnel)
          example: "2025-07-15T23:00:00Z"
        price:
          type: number
          format: float
          minimum: 0
          description: Prix d'entr√©e en euros (0 si gratuit)
          example: 15.00
        max_attendees:
          type: integer
          minimum: 1
          description: Nombre maximum de participants
          nullable: true
          example: 200
        current_attendees:
          type: integer
          minimum: 0
          description: Nombre actuel d'inscrits
          readOnly: true
          example: 45
        location:
          $ref: '#/components/schemas/Location'
        tags:
          type: array
          items:
            type: string
          description: Tags pour cat√©goriser l'√©v√©nement
          example: ["musique", "jazz", "ext√©rieur"]
        created_at:
          type: string
          format: date-time
          description: Date de cr√©ation
          readOnly: true
          example: "2025-06-01T10:00:00Z"

    EventInput:
      type: object
      required:
        - title
        - type
        - start_date
        - location
      properties:
        title:
          type: string
          minLength: 3
          maxLength: 200
          example: "Concert de Rock"
        description:
          type: string
          maxLength: 2000
          example: "Soir√©e rock avec groupes locaux"
        type:
          type: string
          enum: [concert, exposition, conference, festival, sport, autre]
          example: "concert"
        start_date:
          type: string
          format: date-time
          example: "2025-08-15T20:00:00Z"
        end_date:
          type: string
          format: date-time
          example: "2025-08-15T23:30:00Z"
        price:
          type: number
          format: float
          minimum: 0
          default: 0
          example: 25.00
        max_attendees:
          type: integer
          minimum: 1
          example: 5000
        location:
          $ref: '#/components/schemas/LocationInput'
        tags:
          type: array
          items:
            type: string
          example: ["musique", "rock"]

    Location:
      type: object
      required:
        - name
        - city
      properties:
        name:
          type: string
          description: Nom du lieu
          example: "Place du Capitole"
        address:
          type: string
          description: Adresse compl√®te
          example: "Place du Capitole, 31000 Toulouse"
        city:
          type: string
          description: Ville
          example: "Toulouse"
        postal_code:
          type: string
          description: Code postal
          example: "31000"
        coordinates:
          type: object
          properties:
            latitude:
              type: number
              format: float
              example: 43.6047
            longitude:
              type: number
              format: float
              example: 1.4442

    LocationInput:
      type: object
      required:
        - name
        - city
      properties:
        name:
          type: string
          example: "Zenith de Toulouse"
        address:
          type: string
          example: "11 Avenue Raymond Badiou, 31300 Toulouse"
        city:
          type: string
          example: "Toulouse"
        postal_code:
          type: string
          example: "31300"</code>
              </div>

              <h5 class="mt-5">√âl√©ments cl√©s d'un bon fichier OpenAPI</h5>
              <ul>
                <li><strong>Section `info`</strong> : M√©tadonn√©es compl√®tes avec description, contact, licence. La description peut inclure du Markdown pour formater du texte riche.</li>
                <li><strong>Section `servers`</strong> : Liste les diff√©rents environnements. Le client peut choisir o√π envoyer ses requ√™tes.</li>
                <li><strong>Section `paths`</strong> : Le c≈ìur de la spec. Chaque endpoint avec toutes ses m√©thodes HTTP, param√®tres, corps de requ√™tes, r√©ponses possibles.</li>
                <li><strong>Section `components`</strong> : D√©finitions r√©utilisables. Utilisez `$ref` pour √©viter la duplication. Sch√©mas, r√©ponses d'erreur, m√©canismes de s√©curit√©.</li>
                <li><strong>Section `tags`</strong> : Permet de grouper les endpoints par th√©matique dans la documentation g√©n√©r√©e.</li>
                <li><strong>Exemples multiples</strong> : Utilisez `examples` (au pluriel) pour montrer diff√©rents cas d'usage. Tr√®s utile pour les d√©veloppeurs.</li>
              </ul>

              <h4 class="mt-5"><i class="fas fa-play"></i> G√©n√©ration de documentation interactive</h4>
              <p>Le grand avantage d'OpenAPI : g√©n√©ration automatique d'une belle documentation interactive.</p>

              <h5 class="mt-5">Swagger UI</h5>
              <p>Swagger UI est l'outil le plus populaire. Il lit votre OpenAPI et g√©n√®re une interface web o√π les d√©veloppeurs peuvent :</p>
              <ul>
                <li>Voir tous les endpoints group√©s par tags</li>
                <li>Voir les sch√©mas de donn√©es avec exemples</li>
                <li><strong>Tester les endpoints directement depuis le navigateur</strong></li>
                <li>Voir les codes de r√©ponse possibles</li>
                <li>Copier des exemples de requ√™tes</li>
              </ul>

              <h5 class="mt-5">Int√©gration Node.js/Express :</h5>
              <div class="code-example">
                <pre><code class="javascript">const swaggerUi = require('swagger-ui-express');
const YAML = require('yamljs');
const swaggerDocument = YAML.load('./openapi.yaml');

app.use('/api-docs', swaggerUi.serve, swaggerUi.setup(swaggerDocument, {
  customCss: '.swagger-ui .topbar { display: none }',
  customSiteTitle: "SmartCity API Documentation"
}));</code></pre>
              </div>
              
              <p>Allez sur `http://localhost:3000/api-docs` et vous avez votre documentation interactive.</p>

              <h5 class="mt-5">Redoc</h5>
              <p>Alternative plus moderne visuellement, optimis√©e pour la lecture plut√¥t que pour tester.</p>
              
              <div class="code-example">
                <pre><code class="javascript">const redoc = require('redoc-express');

app.get('/docs', redoc({
  title: 'SmartCity API Documentation',
  specUrl: '/openapi.yaml',
  nonce: '',
  redocOptions: {
    theme: {
      colors: {
        primary: { main: '#2563eb' }
      }
    }
  }
}));</code></pre>
              </div>

              <h5 class="mt-5">Comparaison des outils</h5>
              <div class="comparison-box">
                <div class="good-example">
                  <h6>Swagger UI :</h6>
                  <ul>
                    <li>‚úÖ Le plus populaire et mature</li>
                    <li>‚úÖ Excellent pour tester les endpoints</li>
                    <li>‚úÖ Try-it-out int√©gr√©</li>
                    <li>‚ùå Design un peu dat√©</li>
                  </ul>
                </div>
                <div class="good-example">
                  <h6>Redoc :</h6>
                  <ul>
                    <li>‚úÖ Tr√®s beau design moderne</li>
                    <li>‚úÖ Optimis√© pour la lecture</li>
                    <li>‚úÖ Navigation fluide</li>
                    <li>‚ùå Moins bon pour tester interactivement</li>
                  </ul>
                </div>
              </div>
              
              <div class="highlight-box">
                <h6>üí° Recommandation</h6>
                <p>Pour SmartCity, commencez avec <strong>Swagger UI</strong>. C'est le standard de l'industrie.</p>
              </div>

              <h4 class="mt-5"><i class="fas fa-check-circle"></i> Bonnes pratiques de documentation</h4>
              
              <h5 class="mt-5">1. Design-first vs Code-first</h5>
              <p><strong>Design-first :</strong> Vous √©crivez d'abord le contrat OpenAPI, validez-le avec l'√©quipe, puis impl√©mentez le code.</p>
              <ul>
                <li><strong>Avantage :</strong> Force √† bien penser l'API avant de coder</li>
                <li><strong>Inconv√©nient :</strong> Risque de d√©synchronisation doc/code</li>
              </ul>
              
              <p><strong>Code-first :</strong> Vous codez d'abord, puis g√©n√©rez l'OpenAPI depuis le code (avec annotations/d√©corateurs).</p>
              <ul>
                <li><strong>Avantage :</strong> Doc toujours synchronis√©e</li>
                <li><strong>Inconv√©nient :</strong> Moins de r√©flexion sur le design</li>
              </ul>
              
              <div class="highlight-box">
                <h6>üéØ Recommandation</h6>
                <p>Pour des APIs publiques, <strong>design-first</strong> est meilleur. Pour des APIs internes, <strong>code-first</strong> peut suffire.</p>
              </div>

              <h5 class="mt-5">2. Exemples concrets et multiples</h5>
              <p>Chaque sch√©ma devrait avoir au moins un exemple. Les endpoints complexes devraient avoir plusieurs exemples montrant diff√©rents cas d'usage.</p>
              
              <div class="comparison-box">
                <div class="bad-example">
                  <h6>‚ùå Mauvais (juste un sch√©ma abstrait):</h6>
                  <div class="code-example">
                    <pre><code class="yaml">schema:
  type: object
  properties:
    title: string
    price: number</code></pre>
                  </div>
                </div>
                <div class="good-example">
                  <h6>‚úÖ Bon (sch√©ma + exemples multiples):</h6>
                  <div class="code-example">
                    <pre><code class="yaml">schema:
  $ref: '#/components/schemas/EventInput'
examples:
  concert:
    summary: Cr√©ation d'un concert payant
    value:
      title: "Concert de Rock"
      type: "concert"
      price: 25.00
  exposition:
    summary: Exposition gratuite
    value:
      title: "Photos du Monde"
      type: "exposition"
      price: 0</code></pre>
                  </div>
                </div>
              </div>

              <h5 class="mt-5">3. Descriptions riches en Markdown</h5>
              <p>OpenAPI supporte le Markdown dans les descriptions. Utilisez-le !</p>
              
              <div class="code-example">
                <pre><code class="yaml">description: |
  ## Authentification requise
  
  Cet endpoint n√©cessite un JWT token valide.
  
  ## Permissions
  
  - **user** : Peut cr√©er des √©v√©nements
  - **admin** : Peut cr√©er et supprimer
  
  ## Limites
  
  - Maximum 100 √©v√©nements par jour par utilisateur
  - Titre entre 3 et 200 caract√®res</code></pre>
              </div>

              <h5 class="mt-5">4. Documentez TOUS les codes de r√©ponse</h5>
              <p>Ne documentez pas seulement le 200 Success. Documentez les erreurs aussi !</p>
              
              <div class="code-example">
                <pre><code class="yaml">responses:
  '200':
    description: Succ√®s
  '400':
    description: JSON invalide ou param√®tres manquants
  '401':
    description: Token manquant ou invalide
  '403':
    description: Permissions insuffisantes (r√¥le user au lieu d'admin)
  '404':
    description: √âv√©nement non trouv√©
  '422':
    description: Validation √©chou√©e (titre trop court, date pass√©e...)
  '429':
    description: Trop de requ√™tes (rate limit d√©pass√©)
  '500':
    description: Erreur serveur</code></pre>
              </div>

              <h5 class="mt-5">5. R√©utilisez avec $ref</h5>
              <p>Au lieu de r√©p√©ter les m√™mes sch√©mas partout :</p>
              
              <div class="comparison-box">
                <div class="bad-example">
                  <h6>‚ùå Mauvais - r√©p√©tition</h6>
                  <div class="code-example">
                    <pre><code class="yaml">paths:
  /events/{id}:
    get:
      responses:
        '404':
          content:
            application/problem+json:
              schema:
                type: object
                properties:
                  type: string
                  title: string
                  status: integer</code></pre>
                  </div>
                </div>
                <div class="good-example">
                  <h6>‚úÖ Bon - r√©utilisation</h6>
                  <div class="code-example">
                    <pre><code class="yaml">paths:
  /events/{id}:
    get:
      responses:
        '404':
          $ref: '#/components/responses/NotFound'</code></pre>
                  </div>
                </div>
              </div>

              <h5 class="mt-5">6. Versionnez la documentation avec le code</h5>
              <p>Votre fichier OpenAPI doit √™tre versionn√© dans Git avec votre code. √Ä chaque commit qui change l'API, le fichier OpenAPI change aussi.</p>
              
              <div class="code-example">
                <pre><code class="text">git log openapi.yaml
commit abc123 - feat: add max_attendees field to events
commit def456 - fix: correct validation rules for postal_code
commit ghi789 - feat: add DELETE /events/{id} endpoint</code></pre>
              </div>

              <h5 class="mt-5">7. Changelog visible</h5>
              <p>Maintenez un changelog pour que les d√©veloppeurs voient ce qui a chang√©.</p>
              
              <div class="code-example">
                <pre><code class="markdown">## Changelog

### v1.2.0 (2025-11-15)
**New features:**
- Nouveau champ `tags` sur les √©v√©nements
- Support filtrage par tag: `?tags=musique,jazz`
- Nouveau endpoint `GET /events/popular`

**Bug fixes:**
- Correction validation code postal (accepte maintenant 5 chiffres)

### v1.1.0 (2025-09-01)
**New features:**
- Ajout champ `image_url` optionnel
- Support tri par prix: `?sort=price` ou `?sort=-price`</code></pre>
              </div>

              <h4 class="mt-5"><i class="fas fa-shield-alt"></i> Validation automatique</h4>
              <p>Un avantage √©norme : validation automatique des requ√™tes/r√©ponses contre la spec.</p>

              <h5 class="mt-5">Validation c√¥t√© serveur</h5>
              <p>Des biblioth√®ques comme express-openapi-validator valident automatiquement toutes les requ√™tes entrantes.</p>
              
              <div class="code-example">
                <pre><code class="javascript">const OpenApiValidator = require('express-openapi-validator');

app.use(
  OpenApiValidator.middleware({
    apiSpec: './openapi.yaml',
    validateRequests: true,     // Valide les requ√™tes entrantes
    validateResponses: true,     // Valide les r√©ponses sortantes (dev uniquement)
    validateSecurity: true,      // Valide l'authentification
  })
);

// Si une requ√™te ne match pas la spec, erreur 400 automatique
// Si une r√©ponse ne match pas la spec, erreur 500 + log d√©taill√©</code></pre>
              </div>
              
              <p>Vous n'avez plus besoin d'√©crire manuellement la validation de chaque champ !</p>

              <h5 class="mt-5">Tests de contrat</h5>
              <p>Testez que votre impl√©mentation respecte le contrat OpenAPI.</p>
              
              <div class="code-example">
                <pre><code class="javascript">const request = require('supertest');
const validator = require('swagger-parser');

describe('Contract Tests', () => {
  it('should validate OpenAPI spec', async () => {
    await validator.validate('./openapi.yaml');
  });
  
  it('GET /events should match spec', async () => {
    const res = await request(app).get('/api/v1/events');
    expect(res.status).toBe(200);
    expect(res.body).toHaveProperty('data');
    expect(res.body).toHaveProperty('meta');
    expect(Array.isArray(res.body.data)).toBe(true);
  });
});</code></pre>
              </div>
            </div>
          </div>
        </div>

        <div class="day-card expanded">
          <div class="day-header">
            <span class="day-number">3</span>
            <span class="day-theme">HATEOAS et API Hypermedia</span>
          </div>
          <div class="day-content">
            <div class="day-morning">
              <h4><i class="fas fa-link"></i> Qu'est-ce que HATEOAS ?</h4>
              <p>HATEOAS signifie "Hypermedia As The Engine Of Application State". C'est la contrainte REST la moins impl√©ment√©e et la moins comprise.</p>
              
              <p>L'id√©e : une API devrait √™tre d√©couvrable. Le client ne devrait pas avoir besoin de conna√Ætre toutes les URLs √† l'avance. Le serveur envoie des liens vers les actions possibles, et le client suit ces liens.</p>
              
              <p>C'est exactement comme le web fonctionne. Sur Wikipedia, vous ne connaissez pas toutes les URLs des articles. Vous cliquez sur des liens. Chaque page contient des liens vers d'autres pages pertinentes.</p>

              <h4 class="mt-5"><i class="fas fa-balance-scale"></i> Exemple sans et avec HATEOAS</h4>
              
              <h5 class="mt-5">Sans HATEOAS (API classique)</h5>
              <div class="json-example">
                <pre><code>{
  "id": 123,
  "status": "pending_payment",
  "total": 99.99
}</code></pre>
              </div>
              
              <p>Le client doit conna√Ætre la logique : "Si status est pending_payment, je peux POST √† /orders/123/payment". Cette logique est cod√©e en dur c√¥t√© client.</p>

              <h5 class="mt-5">Avec HATEOAS</h5>
              <div class="json-example">
                <pre><code>{
  "id": 123,
  "status": "pending_payment",
  "total": 99.99,
  "_links": {
    "self": {
      "href": "/orders/123",
      "method": "GET"
    },
    "payment": {
      "href": "/orders/123/payment",
      "method": "POST",
      "title": "Payer cette commande"
    },
    "cancel": {
      "href": "/orders/123",
      "method": "DELETE",
      "title": "Annuler cette commande"
    }
  }
}</code></pre>
              </div>
              
              <p>Le serveur dit au client : "Voici les actions possibles". Si la commande √©tait d√©j√† pay√©e :</p>
              
              <div class="json-example">
                <pre><code>{
  "id": 123,
  "status": "paid",
  "total": 99.99,
  "_links": {
    "self": {
      "href": "/orders/123",
      "method": "GET"
    },
    "invoice": {
      "href": "/orders/123/invoice.pdf",
      "method": "GET",
      "title": "T√©l√©charger la facture"
    },
    "track": {
      "href": "/orders/123/tracking",
      "method": "GET",
      "title": "Suivre la livraison"
    }
  }
}</code></pre>
              </div>
              
              <p>Les liens changent selon l'√©tat. Le client regarde quels liens sont pr√©sents et affiche les boutons correspondants. Pas besoin de conna√Ætre la logique m√©tier.</p>

              <h4 class="mt-5"><i class="fas fa-file-code"></i> Formats standards</h4>
              
              <h5 class="mt-5">HAL (Hypertext Application Language)</h5>
              <p>Le format le plus simple et populaire pour HATEOAS.</p>
              
              <div class="json-example">
                <pre><code>{
  "id": 123,
  "name": "Marie Dupont",
  "email": "marie@example.com",
  "_links": {
    "self": {
      "href": "/users/123"
    },
    "orders": {
      "href": "/users/123/orders"
    },
    "avatar": {
      "href": "/users/123/avatar.jpg"
    }
  },
  "_embedded": {
    "recent_orders": [
      {
        "id": 456,
        "total": 99.99,
        "_links": {
          "self": { "href": "/orders/456" }
        }
      }
    ]
  }
}</code></pre>
              </div>
              
              <ul>
                <li><strong>`_links`</strong> : Liens vers ressources li√©es</li>
                <li><strong>`_embedded`</strong> : Ressources li√©es incluses directement (√©vite requ√™tes suppl√©mentaires)</li>
              </ul>

              <h5 class="mt-5">JSON:API</h5>
              <p>Standard plus complet et strict.</p>
              
              <div class="json-example">
                <pre><code>{
  "data": {
    "type": "users",
    "id": "123",
    "attributes": {
      "name": "Marie Dupont",
      "email": "marie@example.com"
    },
    "relationships": {
      "orders": {
        "links": {
          "self": "/users/123/relationships/orders",
          "related": "/users/123/orders"
        }
      }
    },
    "links": {
      "self": "/users/123"
    }
  }
}</code></pre>
              </div>
              
              <p>JSON:API est tr√®s structur√© avec conventions strictes. Excellent pour la coh√©rence, mais plus verbeux.</p>

              <h4 class="mt-5"><i class="fas fa-check-circle"></i> Avantages de HATEOAS</h4>
              
              <h5 class="mt-5">D√©couvrabilit√©</h5>
              <p>Un client peut explorer l'API en suivant les liens, comme on explore le web. Imaginons une API de e-commerce. Un client commence par `GET /`. La r√©ponse contient des liens vers `/products`, `/categories`, `/cart`. En suivant ces liens, le client d√©couvre toute l'API sans documentation pr√©alable.</p>

              <h5 class="mt-5">Logique m√©tier c√¥t√© serveur</h5>
              <p>Les r√®gles m√©tier ("peut-on annuler cette commande ?", "peut-on modifier cet √©v√©nement ?") restent sur le serveur. Le serveur d√©cide dynamiquement quels liens inclure selon l'√©tat de la ressource et les permissions de l'utilisateur. Le client affiche simplement les actions disponibles.</p>

              <h5 class="mt-5">√âvolutivit√©</h5>
              <p>Si vous ajoutez une nouvelle action possible, vous ajoutez juste un nouveau lien. Les anciens clients qui ne connaissent pas ce lien l'ignorent. Les nouveaux clients qui le reconnaissent peuvent l'utiliser. Pas de breaking change.</p>

              <h5 class="mt-5">Documentation vivante</h5>
              <p>La r√©ponse elle-m√™me documente ce qui est possible. Un d√©veloppeur qui explore l'API voit imm√©diatement quelles actions sont disponibles sur chaque ressource.</p>

              <h5 class="mt-5">Exemple concret</h5>
              <p>Imaginons un syst√®me de r√©servation d'√©v√©nements.</p>
              
              <div class="json-example">
                <pre><code>{
  "id": "550e8400-e29b-41d4-a716-446655440000",
  "title": "Concert de Jazz",
  "status": "open",
  "current_attendees": 45,
  "max_attendees": 200,
  "_links": {
    "self": "/events/550e8400-e29b-41d4-a716-446655440000",
    "register": {
      "href": "/events/550e8400-e29b-41d4-a716-446655440000/register",
      "method": "POST",
      "title": "S'inscrire √† cet √©v√©nement"
    },
    "attendees": "/events/550e8400-e29b-41d4-a716-446655440000/attendees"
  }
}</code></pre>
              </div>
              
              <p>Si l'√©v√©nement est complet :</p>
              
              <div class="json-example">
                <pre><code>{
  "id": "550e8400-e29b-41d4-a716-446655440000",
  "title": "Concert de Jazz",
  "status": "full",
  "current_attendees": 200,
  "max_attendees": 200,
  "_links": {
    "self": "/events/550e8400-e29b-41d4-a716-446655440000",
    "attendees": "/events/550e8400-e29b-41d4-a716-446655440000/attendees"
  }
}</code></pre>
              </div>
              
              <p>Le lien `register` a disparu. Le client sait imm√©diatement que l'inscription n'est plus possible sans avoir √† conna√Ætre la logique "si current_attendees >= max_attendees alors pas d'inscription".</p>

              <h4 class="mt-5"><i class="fas fa-exclamation-triangle"></i> Inconv√©nients et limitations</h4>
              
              <h5 class="mt-5">Complexit√© d'impl√©mentation</h5>
              <p>G√©n√©rer les liens dynamiquement selon l'√©tat de la ressource et les permissions de l'utilisateur est plus complexe que renvoyer juste les donn√©es. Vous devez √©crire de la logique pour d√©terminer quels liens inclure dans chaque situation.</p>

              <h5 class="mt-5">Verbosit√©</h5>
              <p>Les r√©ponses sont plus grosses avec tous ces liens. Pour une API haute performance o√π chaque octet compte, c'est un co√ªt. Une r√©ponse qui faisait 500 octets peut facilement doubler de taille.</p>

              <h5 class="mt-5">Adoption faible</h5>
              <p>Dans la r√©alit√©, tr√®s peu d'APIs publiques impl√©mentent HATEOAS compl√®tement. M√™me les APIs qui se disent "RESTful" ne le font g√©n√©ralement pas. GitHub, Twitter, Stripe... aucune n'impl√©mente HATEOAS de mani√®re stricte.</p>

              <h5 class="mt-5">Clients non pr√©par√©s</h5>
              <p>La plupart des clients (applications mobiles, SPAs) ne sont pas con√ßus pour suivre des liens dynamiquement. Ils ont leurs URLs cod√©es en dur : `const API_URL = 'https://api.example.com/orders'`. Ils ne vont pas parser les liens de la r√©ponse pour d√©couvrir les actions possibles. Ils affichent des boutons selon leur propre logique.</p>

              <h5 class="mt-5">Overhead mental</h5>
              <p>Pour les d√©veloppeurs habitu√©s aux APIs REST classiques, HATEOAS ajoute une couche de complexit√© conceptuelle. "Pourquoi je dois g√©n√©rer tous ces liens alors que le client conna√Æt d√©j√† les URLs ?"</p>

              <h5 class="mt-5">Pas de standard universel</h5>
              <p>HAL, JSON:API, Siren... plusieurs standards existent. Choisir lequel utiliser et former l'√©quipe ajoute de la friction.</p>

              <h4 class="mt-5"><i class="fas fa-road"></i> Approche pragmatique pour SmartCity</h4>
              <p>Pour votre projet, voici une approche progressive par niveaux :</p>

              <h5 class="mt-5">Niveau 0 : Pas de liens (acceptable pour MVP)</h5>
              <div class="json-example">
                <pre><code>{
  "id": 123,
  "title": "Concert de Jazz",
  "status": "open"
}</code></pre>
              </div>
              
              <p>Simple, direct. Aucune hypermedia. Le client conna√Æt toutes les URLs. C'est ce que font 80% des APIs.</p>

              <h5 class="mt-5">Niveau 1 : Lien self uniquement (recommand√© minimum)</h5>
              <div class="json-example">
                <pre><code>{
  "id": 123,
  "title": "Concert de Jazz",
  "status": "open",
  "_links": {
    "self": "/events/123"
  }
}</code></pre>
              </div>
              
              <p>Ajoute juste un lien vers la ressource elle-m√™me. Tr√®s utile quand vous recevez une liste d'objets : chaque objet contient son URL compl√®te. Le client n'a pas √† construire l'URL lui-m√™me.</p>

              <h5 class="mt-5">Niveau 2 : Liens vers ressources li√©es (bon √©quilibre)</h5>
              <div class="json-example">
                <pre><code>{
  "id": 123,
  "title": "Concert de Jazz",
  "status": "open",
  "current_attendees": 45,
  "max_attendees": 200,
  "_links": {
    "self": "/events/123",
    "attendees": "/events/123/attendees",
    "creator": "/users/456",
    "register": {
      "href": "/events/123/register",
      "method": "POST",
      "title": "S'inscrire"
    }
  }
}</code></pre>
              </div>
              
              <p>Inclut des liens vers les ressources li√©es et les actions possibles. Le client peut facilement naviguer vers les participants, le cr√©ateur de l'√©v√©nement, ou s'inscrire. C'est un bon √©quilibre entre utilit√© et complexit√©.</p>

              <h5 class="mt-5">Niveau 3 : HAL ou JSON:API complet (pour les puristes)</h5>
              <p>HAL complet avec `_embedded` :</p>
              
              <div class="json-example">
                <pre><code>{
  "id": 123,
  "title": "Concert de Jazz",
  "status": "open",
  "_links": {
    "self": { "href": "/events/123" },
    "attendees": { "href": "/events/123/attendees" },
    "creator": { "href": "/users/456" }
  },
  "_embedded": {
    "creator": {
      "id": 456,
      "name": "Marie Dupont",
      "_links": {
        "self": { "href": "/users/456" }
      }
    }
  }
}</code></pre>
              </div>
              
              <p>Tr√®s complet, mais aussi tr√®s verbeux. R√©serv√© aux cas o√π vous avez vraiment besoin de ce niveau de sophistication.</p>
              
              <div class="highlight-box">
                <h6>üéØ Recommandation pour SmartCity</h6>
                <p>Visez le <strong>niveau 2</strong>. Assez de liens pour √™tre utile et moderne, sans la complexit√© du HAL/JSON:API complet. C'est ce que font beaucoup d'APIs modernes bien con√ßues.</p>
              </div>

              <h4 class="mt-5"><i class="fas fa-code"></i> Impl√©mentation simple</h4>
              <p>Voici comment ajouter des liens basiques dans votre API Node.js :</p>
              
              <div class="code-example">
                <pre><code class="javascript">// Helper pour g√©n√©rer les liens
function addLinks(event, baseUrl, user) {
  event._links = {
    self: `${baseUrl}/events/${event.id}`
  };
  
  // Toujours inclure le lien vers les participants
  event._links.attendees = `${baseUrl}/events/${event.id}/attendees`;
  
  // Lien vers le cr√©ateur
  if (event.creator_id) {
    event._links.creator = `${baseUrl}/users/${event.creator_id}`;
  }
  
  // Liens conditionnels selon l'√©tat de l'√©v√©nement
  if (event.status === 'open') {
    // Peut-on s'inscrire ? V√©rifier qu'il reste de la place
    if (!event.max_attendees || event.current_attendees < event.max_attendees) {
      event._links.register = {
        href: `${baseUrl}/events/${event.id}/register`,
        method: 'POST',
        title: 'S\'inscrire √† cet √©v√©nement'
      };
    }
    
    // Peut-on modifier ? V√©rifier les permissions
    if (user && (user.id === event.creator_id || user.role === 'admin')) {
      event._links.update = {
        href: `${baseUrl}/events/${event.id}`,
        method: 'PATCH',
        title: 'Modifier cet √©v√©nement'
      };
    }
    
    // Peut-on supprimer ? V√©rifier les permissions
    if (user && (user.id === event.creator_id || user.role === 'admin')) {
      event._links.delete = {
        href: `${baseUrl}/events/${event.id}`,
        method: 'DELETE',
        title: 'Supprimer cet √©v√©nement'
      };
    }
  }
  
  return event;
}</code></pre>
              </div>

              <h4 class="mt-5"><i class="fas fa-lightbulb"></i> Cas d'usage r√©els</h4>
              
              <h5 class="mt-5">Cas 1 : Interface adaptative</h5>
              <p>Imaginons une application front-end qui affiche un √©v√©nement. Au lieu de coder en dur :</p>
              
              <div class="comparison-box">
                <div class="bad-example">
                  <h6>‚ùå Logique en dur c√¥t√© client</h6>
                  <div class="code-example">
                    <pre><code class="javascript">if (event.status === 'open' && event.current_attendees < event.max_attendees) {
  showButton('S\'inscrire');
}
if (user.id === event.creator_id || user.role === 'admin') {
  showButton('Modifier');
  showButton('Supprimer');
}</code></pre>
                  </div>
                </div>
                <div class="good-example">
                  <h6>‚úÖ Logique c√¥t√© serveur</h6>
                  <div class="code-example">
                    <pre><code class="javascript">if (event._links.register) {
  showButton('S\'inscrire', event._links.register.href);
}
if (event._links.update) {
  showButton('Modifier', event._links.update.href);
}
if (event._links.delete) {
  showButton('Supprimer', event._links.delete.href);
}</code></pre>
                  </div>
                </div>
              </div>
              
              <p>Le client affiche juste les boutons pour les liens pr√©sents. La logique m√©tier reste sur le serveur.</p>

              <h5 class="mt-5">Cas 2 : √âvolution sans breaking change</h5>
              <p>Vous ajoutez une nouvelle fonctionnalit√© : dupliquer un √©v√©nement.</p>
              
              <p><strong>Sans HATEOAS :</strong> Vous devez mettre √† jour tous les clients pour qu'ils sachent que `POST /events/{id}/duplicate` existe maintenant.</p>
              
              <p><strong>Avec HATEOAS :</strong> Vous ajoutez juste le lien dans la r√©ponse :</p>
              
              <div class="json-example">
                <pre><code>{
  "id": 123,
  "title": "Concert",
  "_links": {
    "self": "/events/123",
    "duplicate": {
      "href": "/events/123/duplicate",
      "method": "POST",
      "title": "Dupliquer cet √©v√©nement"
    }
  }
}</code></pre>
              </div>
              
              <p>Les anciens clients ignorent ce lien. Les nouveaux clients qui savent le g√©rer affichent un bouton "Dupliquer". Pas de breaking change.</p>

              <h5 class="mt-5">Cas 3 : D√©couverte d'API</h5>
              <p>Un d√©veloppeur teste votre API pour la premi√®re fois. Il fait `GET /` :</p>
              
              <div class="json-example">
                <pre><code>{
  "message": "Bienvenue sur l'API SmartCity",
  "version": "1.0.0",
  "_links": {
    "events": "/events",
    "users": "/users",
    "auth": "/auth/login",
    "docs": "/api-docs"
  }
}</code></pre>
              </div>
              
              <p>En suivant ces liens, il d√©couvre progressivement toute l'API. C'est comme explorer Wikipedia en suivant les liens.</p>

              <h4 class="mt-5"><i class="fas fa-times-circle"></i> Quand ne PAS utiliser HATEOAS</h4>
              
              <ul>
                <li><strong>API interne entre microservices :</strong> Si vos services se connaissent bien et communiquent en permanence, HATEOAS ajoute juste de la verbosit√© inutile.</li>
                <li><strong>API haute performance :</strong> Si chaque milliseconde et chaque octet comptent (gaming, trading haute fr√©quence), le overhead de HATEOAS n'en vaut pas la peine.</li>
                <li><strong>√âquipe pas form√©e :</strong> Si votre √©quipe ne comprend pas HATEOAS et n'y voit pas de valeur, forcer son adoption cr√©era plus de friction que de b√©n√©fices.</li>
                <li><strong>Clients simples :</strong> Si vos clients sont de simples scripts qui font `GET /data` et c'est tout, pas besoin de sophistication.</li>
              </ul>

              <h4 class="mt-5"><i class="fas fa-check-double"></i> Conclusion sur HATEOAS</h4>
              <p>HATEOAS est √©l√©gant en th√©orie. C'est la vision originale de REST par Roy Fielding. Mais dans la pratique, tr√®s peu d'APIs l'impl√©mentent compl√®tement car :</p>
              <ul>
                <li>La complexit√© d'impl√©mentation n'en vaut pas toujours la peine</li>
                <li>Les clients modernes ne sont g√©n√©ralement pas con√ßus pour exploiter l'hypermedia</li>
                <li>√áa rend les r√©ponses plus grosses</li>
              </ul>
              
              <div class="highlight-box">
                <h6>üéØ Recommandation finale</h6>
                <p>Pour SmartCity, une approche pragmatique : ajoutez au minimum un lien `self`, et si vous avez le temps, ajoutez des liens vers les ressources li√©es et les actions conditionnelles. Vous aurez une API moderne et bien con√ßue sans tomber dans la sur-ing√©nierie.</p>
                <p><strong>Le plus important :</strong> soyez coh√©rent. Si vous ajoutez des liens, faites-le partout de la m√™me mani√®re. Si vous ne les ajoutez pas, assumez ce choix. L'incoh√©rence est pire que l'absence de liens.</p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Footer -->
  <footer class="footer">
    <div class="container">
      <div class="footer-content">
        <div class="footer-section">
          <div class="footer-logo">
            <img src="../assets/logo.jpeg" alt="YNOV Campus" class="footer-logo-img">
            <span class="footer-logo-text">Web Services</span>
          </div>
          <p class="footer-description">Jour 3 ‚Äî D√©veloppement d'API REST Avanc√©.</p>
        </div>
        <div class="footer-section">
          <h3>Navigation</h3>
          <ul>
            <li><a href="../index.html">Accueil</a></li>
            <li><a href="day1.html">Jour 1 - Th√©orie</a></li>
            <li><a href="day2.html">Jour 2 - Th√©orie</a></li>
            <li><a href="day3.html">Jour 3 - Th√©orie</a></li>
          </ul>
        </div>
        <div class="footer-section">
          <h3>Ressources</h3>
          <ul>
            <li><a href="day1FilRouge.html">Fil Rouge J1</a></li>
            <li><a href="day2FilRouge.html">Fil Rouge J2</a></li>
            <li><a href="day3FilRouge.html">Fil Rouge J3</a></li>
          </ul>
        </div>
        <div class="footer-section">
          <h3>Contact</h3>
          <p>Formation Web Services</p>
          <p>YNOV Campus</p>
        </div>
      </div>
      <div class="footer-bottom">
        <p>&copy; 2024 YNOV Campus. Tous droits r√©serv√©s.</p>
      </div>
    </div>
  </footer>

  <script src="../script.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
  <script>
    // Auto-d√©tection et coloration de tous les blocs de code
    document.addEventListener('DOMContentLoaded', function() {
      hljs.highlightAll();
    });
  </script>
</body>
</html>
